<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>JavaScript高级程序设计第四版-第六章-笔记 | 王小明</title><meta name="description" content="笔记"><meta name="keywords" content="读后笔记"><meta name="author" content="Decade W"><meta name="copyright" content="Decade W"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><script src="https://code.jquery.com/jquery-3.4.1.min.js"></script><meta name="twitter:card" content="summary"><meta name="twitter:title" content="JavaScript高级程序设计第四版-第六章-笔记"><meta name="twitter:description" content="笔记"><meta name="twitter:image" content="http://blog.decade.run/img/post.jpg"><meta property="og:type" content="article"><meta property="og:title" content="JavaScript高级程序设计第四版-第六章-笔记"><meta property="og:url" content="http://blog.decade.run/2020/12/22/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="王小明"><meta property="og:description" content="笔记"><meta property="og:image" content="http://blog.decade.run/img/post.jpg"><meta property="article:published_time" content="2020-12-22T05:08:14.000Z"><meta property="article:modified_time" content="2021-01-25T07:48:53.100Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://blog.decade.run/2020/12/22/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%AC%94%E8%AE%B0/"><link rel="prev" title="JavaScript高级程序设计第四版-第七章-笔记" href="http://blog.decade.run/2021/01/25/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E4%B8%83%E7%AB%A0-%E7%AC%94%E8%AE%B0/"><link rel="next" title="JavaScript高级程序设计第四版-第五章-笔记" href="http://blog.decade.run/2020/11/19/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%AC%94%E8%AE%B0/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"LEP83554SS","apiKey":"96fa18c62f7619e2bf35df83ba4aef39","indexName":"...","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":0,"translateDelay":1,"cookieDomain":"https://blog.decade.run/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: Decade W","link":"链接: ","source":"来源: 王小明","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: {"text":"努力,学习","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: true
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="王小明" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">56</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">18</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item Home"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item Archives"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item Tag"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tag</span></a></div><div class="menus_item Categories"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item Link"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item About"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Object"><span class="toc-number">1.</span> <span class="toc-text">Object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Array"><span class="toc-number">2.</span> <span class="toc-text">Array</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#创建数组"><span class="toc-number">2.1.</span> <span class="toc-text">创建数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数组空位"><span class="toc-number">2.2.</span> <span class="toc-text">数组空位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数组索引"><span class="toc-number">2.3.</span> <span class="toc-text">数组索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#检测数组"><span class="toc-number">2.4.</span> <span class="toc-text">检测数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#迭代器方法"><span class="toc-number">2.5.</span> <span class="toc-text">迭代器方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#复制和填充方法"><span class="toc-number">2.6.</span> <span class="toc-text">复制和填充方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#栈方法"><span class="toc-number">2.7.</span> <span class="toc-text">栈方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#队列方法"><span class="toc-number">2.8.</span> <span class="toc-text">队列方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#排序方法"><span class="toc-number">2.9.</span> <span class="toc-text">排序方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#操作方法"><span class="toc-number">2.10.</span> <span class="toc-text">操作方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#搜索和位置方法"><span class="toc-number">2.11.</span> <span class="toc-text">搜索和位置方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#按严格相等搜索"><span class="toc-number">2.11.1.</span> <span class="toc-text">按严格相等搜索</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#断言函数"><span class="toc-number">2.11.2.</span> <span class="toc-text">断言函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#迭代方法"><span class="toc-number">2.12.</span> <span class="toc-text">迭代方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#归并方法"><span class="toc-number">2.13.</span> <span class="toc-text">归并方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#定型数组"><span class="toc-number">3.</span> <span class="toc-text">定型数组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ArrayBuffer"><span class="toc-number">3.1.</span> <span class="toc-text">ArrayBuffer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DataView"><span class="toc-number">3.2.</span> <span class="toc-text">DataView</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ElementType"><span class="toc-number">3.2.1.</span> <span class="toc-text">ElementType</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#字节序"><span class="toc-number">3.2.2.</span> <span class="toc-text">字节序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#边界情况"><span class="toc-number">3.2.3.</span> <span class="toc-text">边界情况</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Map"><span class="toc-number">4.</span> <span class="toc-text">Map</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基本API"><span class="toc-number">4.1.</span> <span class="toc-text">基本API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#顺序与迭代"><span class="toc-number">4.2.</span> <span class="toc-text">顺序与迭代</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#选择-Object-还是-Map"><span class="toc-number">4.3.</span> <span class="toc-text">选择 Object 还是 Map</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WeakMap"><span class="toc-number">5.</span> <span class="toc-text">WeakMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基本API-1"><span class="toc-number">5.1.</span> <span class="toc-text">基本API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#弱键"><span class="toc-number">5.2.</span> <span class="toc-text">弱键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#不可迭代键"><span class="toc-number">5.3.</span> <span class="toc-text">不可迭代键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用弱映射"><span class="toc-number">5.4.</span> <span class="toc-text">使用弱映射</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Set"><span class="toc-number">6.</span> <span class="toc-text">Set</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基本API-2"><span class="toc-number">6.1.</span> <span class="toc-text">基本API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#顺序与迭代-1"><span class="toc-number">6.2.</span> <span class="toc-text">顺序与迭代</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#定义正式集合操作"><span class="toc-number">6.3.</span> <span class="toc-text">定义正式集合操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WeakSet"><span class="toc-number">7.</span> <span class="toc-text">WeakSet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基本API-3"><span class="toc-number">7.1.</span> <span class="toc-text">基本API</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div class="post-bg" id="nav" style="background-image: url(/img/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">王小明</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item Home"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item Archives"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item Tag"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tag</span></a></div><div class="menus_item Categories"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item Link"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item About"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">JavaScript高级程序设计第四版-第六章-笔记</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-12-22 13:08:14"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-12-22</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2021-01-25 15:48:53"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2021-01-25</span></time></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">10.6k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 43 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/2020/12/22/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%AC%94%E8%AE%B0/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/12/22/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%AC%94%E8%AE%B0/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h3 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h3><p>到目前为止，大多数引用值的示例使用的是 Object 类型</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>(); </span><br><span class="line">obj.name = <span class="string">"decade"</span>;</span><br><span class="line">obj.age = <span class="number">21</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">    name: <span class="string">"decade"</span>,</span><br><span class="line">    age: <span class="number">21</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.name; <span class="comment">// decade</span></span><br><span class="line">obj[<span class="string">"name"</span>]; <span class="comment">// decade</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">"name"</span>;</span><br><span class="line">obj[str]; <span class="comment">// decade</span></span><br><span class="line"><span class="keyword">let</span> str1 = <span class="string">"ame"</span>;</span><br><span class="line">obj[<span class="string">"n"</span> + str1]; <span class="comment">// decade</span></span><br></pre></td></tr></table></figure>

<h3 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h3><h4 id="创建数组"><a href="#创建数组" class="headerlink" title="创建数组"></a>创建数组</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = <span class="keyword">new</span> <span class="built_in">Array</span>(); <span class="comment">// []</span></span><br><span class="line"><span class="keyword">let</span> arr2 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">5</span>); <span class="comment">// [empty × 5] 传入一个数字 会赋值个length 返回的是一个长度为5的数组</span></span><br><span class="line"><span class="keyword">let</span> arr3 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"5"</span>); <span class="comment">// ["5"]</span></span><br><span class="line"><span class="keyword">let</span> arr4 = []; <span class="comment">// []</span></span><br><span class="line"><span class="keyword">let</span> arr5 = [<span class="string">"1"</span>, <span class="number">1</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="number">5</span>, <span class="string">"decade"</span>]; <span class="comment">// ["1", 1, "2", "3", 5, "decade"]</span></span><br></pre></td></tr></table></figure>

<p>Array.from() 用于将类数组转换为数组, 参数是一个类数组, 即任何可迭代的结构，或者有一个 length 属性和可索引元素的结构</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(<span class="string">"decade"</span>); <span class="comment">// ["d", "e", "c", "a", "d", "e"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">map.set(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">map.set(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">Map</span>(<span class="number">2</span>) &#123;<span class="number">1</span> =&gt; <span class="number">2</span>, <span class="number">2</span> =&gt; <span class="number">3</span>&#125;</span><br><span class="line"><span class="built_in">Array</span>.from(map); <span class="comment">// [Array(2), Array(2)]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">set</span> = new Set();</span><br><span class="line"><span class="keyword">set</span>.add(1);</span><br><span class="line"><span class="keyword">set</span>.add(2);</span><br><span class="line"><span class="keyword">set</span>.add(3); // Set(3) &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line"><span class="built_in">Array</span>.from(<span class="keyword">set</span>); // [1, 2, 3]</span><br><span class="line"></span><br><span class="line">const iter = &#123; </span><br><span class="line"> 	*[<span class="built_in">Symbol</span>.iterator]() &#123; </span><br><span class="line"> 		<span class="keyword">yield</span> <span class="number">1</span>; </span><br><span class="line"> 		<span class="keyword">yield</span> <span class="number">2</span>; </span><br><span class="line"> 		<span class="keyword">yield</span> <span class="number">3</span>; </span><br><span class="line"> 		<span class="keyword">yield</span> <span class="number">4</span>; </span><br><span class="line"> 	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Array</span>.from(iter); <span class="comment">// [1, 2, 3, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="number">0</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="number">3</span>,</span><br><span class="line">    length: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Array</span>.from(obj); <span class="comment">//  [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果没有length属性</span></span><br><span class="line">obj = &#123;</span><br><span class="line">    <span class="number">0</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Array</span>.from(obj); <span class="comment">//  []</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果只有length属性</span></span><br><span class="line">obj = &#123;</span><br><span class="line">    length: <span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Array</span>.from(obj); <span class="comment">// [undefined, undefined, undefined, undefined]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果有length属性 但是对象键值不为数字</span></span><br><span class="line">obj = &#123;</span><br><span class="line">    age: <span class="number">12</span>,</span><br><span class="line">    name: <span class="string">"decade"</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="number">3</span>,</span><br><span class="line">    length: <span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Array</span>.from(obj); <span class="comment">// [undefined, undefined, 3, undefined]</span></span><br></pre></td></tr></table></figure>

<p>Array.from(), 还接收第二个可选的映射函数参数, </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将下面的对象转换成数组 并得到数组每一项值得平方</span></span><br><span class="line"><span class="keyword">let</span> arr = &#123;</span><br><span class="line">    <span class="number">0</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="number">3</span>: <span class="number">4</span>,</span><br><span class="line">    length: <span class="number">4</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 没有使用第二个参数</span></span><br><span class="line"><span class="built_in">Array</span>.from(arr).map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item ** <span class="number">2</span>;</span><br><span class="line">&#125;); <span class="comment">// [1, 4, 9, 16]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用第二个函数参数 方法只有两个形参 一个值 一个下标</span></span><br><span class="line"><span class="built_in">Array</span>.from(arr, (v, i) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> v ** <span class="number">2</span></span><br><span class="line">&#125;); <span class="comment">// [1, 4, 9, 16]</span></span><br></pre></td></tr></table></figure>

<p>Array.from() 还接收第三个参数 用于指定第二个函数参数的this</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(arr, <span class="function"><span class="keyword">function</span>(<span class="params">v, i</span>) </span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>); <span class="comment">// &#123;name: "decade"&#125;</span></span><br><span class="line">&#125;, &#123;<span class="attr">name</span>: <span class="string">"decade"</span>&#125;);</span><br></pre></td></tr></table></figure>

<p>Array.of()可以把一组参数转换为数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)); <span class="comment">// [1, 2, 3, 4] </span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.of(<span class="literal">undefined</span>)); <span class="comment">// [undefined]</span></span><br></pre></td></tr></table></figure>



<h4 id="数组空位"><a href="#数组空位" class="headerlink" title="数组空位"></a>数组空位</h4><p>使用数组字面量初始化数组时，可以使用一串逗号来创建空位（hole）。ECMAScript 会将逗号之间相应索引位置的值当成空位，ES6 规范重新定义了该如何处理这些空位</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [,,,,,]; <span class="comment">// [empty × 5]</span></span><br></pre></td></tr></table></figure>

<p>ES6 新增方法普遍将这些空位当成存在的元素，只不过值为 undefined</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>,,,,,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> arr) &#123; </span><br><span class="line"> 	<span class="built_in">console</span>.log(item === <span class="literal">undefined</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// false</span></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr1 = <span class="built_in">Array</span>.from(arr); <span class="comment">// [1, undefined, undefined, undefined, undefined, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> arr1) &#123; </span><br><span class="line"> 	<span class="built_in">console</span>.log(item === <span class="literal">undefined</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// false</span></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.of(...[,,,]); <span class="comment">// [undefined, undefined, undefined]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> [index, value] <span class="keyword">of</span> arr.entries()) &#123; </span><br><span class="line"> 	<span class="built_in">console</span>.log(value); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"><span class="comment">// 5</span></span><br></pre></td></tr></table></figure>

<p>ES6 之前的方法则会忽略这个空位，但具体的行为也会因方法而异：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>,,,,,<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//  map()会跳过空位置</span></span><br><span class="line">arr.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(item)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 1 0</span></span><br><span class="line"><span class="comment">// 5 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// join()视空位置为空字符串</span></span><br><span class="line">arr.join(<span class="string">'-'</span>); <span class="comment">// "1----5"</span></span><br></pre></td></tr></table></figure>

<p>由于行为不一致和存在性能隐患，因此实践中要避免使用数组空位。如果确实需要空位，则可以显式地用 undefined 值代替</p>
<h4 id="数组索引"><a href="#数组索引" class="headerlink" title="数组索引"></a>数组索引</h4><p>要取得或设置数组的值，需要使用中括号并提供相应值的数字索引</p>
<p>数组 length 属性的独特之处在于，它不是只读的, 通过修改 length 属性，可以从数组末尾删除或添加元素</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"green"</span>];</span><br><span class="line">colors.length = <span class="number">2</span>; </span><br><span class="line"><span class="built_in">console</span>.log(colors); <span class="comment">// ["red", "blue"]</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">2</span>]); <span class="comment">// undefined</span></span><br><span class="line">colors[<span class="number">4</span>] = <span class="string">"pink"</span></span><br><span class="line"><span class="built_in">console</span>.log(colors); <span class="comment">// ["red", "blue", empty × 2, "pink"</span></span><br><span class="line"><span class="built_in">console</span>.log(colors[<span class="number">2</span>]); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<p>数组最多可以包含 4 294 967 295 个元素，这对于大多数编程任务应该足够了。如果尝试添加更多项，则会导致抛出错误。以这个最大值作为初始值创建数组，可能导致脚本运行时间过长的错误</p>
<h4 id="检测数组"><a href="#检测数组" class="headerlink" title="检测数组"></a>检测数组</h4><p>Array.isArray()</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [];</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"是"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"不是"</span>)<span class="string">'</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="迭代器方法"><a href="#迭代器方法" class="headerlink" title="迭代器方法"></a>迭代器方法</h4><p>在 ES6 中，Array 的原型上暴露了 3 个用于检索数组内容的方法：keys()、values()和 entries()。keys()返回数组索引的迭代器，values()返回数组元素的迭代器，而 entries() 返回索引/值对的迭代器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> colors = [<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"green"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// keys() 返回索引的迭代器</span></span><br><span class="line">colors.keys(); <span class="comment">// Array Iterator &#123;&#125;</span></span><br><span class="line"><span class="built_in">Array</span>.from(colors.keys()); <span class="comment">// [0, 1, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// values() 返回值得迭代器</span></span><br><span class="line">colors.values(); <span class="comment">// Array Iterator &#123;&#125;</span></span><br><span class="line"><span class="built_in">Array</span>.from(colors.values()); <span class="comment">// ["red", "blue", "green"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// entries() 返回键值对迭代器</span></span><br><span class="line">colors.entries(); <span class="comment">// Array Iterator &#123;&#125;</span></span><br><span class="line"><span class="built_in">Array</span>.from(colors.entries()); <span class="comment">// [Array(2), Array(2), Array(2)]</span></span><br></pre></td></tr></table></figure>

<h4 id="复制和填充方法"><a href="#复制和填充方法" class="headerlink" title="复制和填充方法"></a>复制和填充方法</h4><p>copyWithin(target, start = 0, end = length) 有三个参数, 三个参数都必须是整数,  这个方法会改变原数组, <strong>下面我的总结说的参数都是传入的是Number类型的</strong></p>
<ul>
<li><p>只传一个参数 第二个参数默认为0 第三个参数默认为数组长度</p>
<p>首先该方法的第一个参数代表着从0到target 即 下标在<code>[0, target)</code>内的元素是不会发生改变的</p>
<p>第一个参数的绝对值小于数组长度时,  按照上面的说法</p>
<p>当绝对值大于或者等于数组长度时, 直接返回原数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(); <span class="comment">// 什么都没传 返回本身</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>); <span class="comment">// [1, 1, 2, 3, 4] 取[0,1)保持不变, 变的就是[1, 5], 被复制的元素为[0, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">2</span>); <span class="comment">// [1, 2, 1, 2, 3]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">3</span>); <span class="comment">// [1, 2, 3, 1, 2]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">4</span>); <span class="comment">// [1, 2, 3, 4, 1]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">5</span>); <span class="comment">// [1, 2, 3, 4, 5] 返回本身</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">6</span>); <span class="comment">// [1, 2, 3, 4, 5] 返回本身 超出数组长度 不发生拷贝</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">-6</span>); <span class="comment">// [1, 2, 3, 4, 5] 返回本身 绝对值超出数组长度 不发生拷贝</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">-5</span>); <span class="comment">// [1, 2, 3, 4, 5] 返回本身</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">-4</span>); <span class="comment">// [1, 1, 2, 3, 4]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">-3</span>); <span class="comment">// [1, 2, 1, 2, 3]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">-2</span>); <span class="comment">// [1, 2, 3, 1, 2]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">-1</span>); <span class="comment">// [1, 2, 3, 4, 1]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>只传两个参数</p>
<p>该方法的第二个参数<code>(我的理解)</code> 就是从原数组开始复制的起点下标</p>
<p>当第二个参数的绝对值大于或者等于数组长度时, 第二个参数会变成0</p>
<p>第二个参数绝对值小于数组长度时, 如果是负数 则复制的的开始下标为 <code>数组长度 + start</code>, 如果是正数 开始下标为 <code>start</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">0</span>); <span class="comment">// [1, 1, 2, 3, 4]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">1</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>); <span class="comment">// [1, 4, 5, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">4</span>); <span class="comment">// [1, 5, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">5</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">6</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-6</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-5</span>); <span class="comment">// [1, 1, 2, 3, 4]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-4</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-3</span>); <span class="comment">// [1, 3, 4, 5, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-2</span>); <span class="comment">// [1, 4, 5, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-1</span>); <span class="comment">// [1, 5, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>三个参数都传</p>
<p>该方法的第三个参数 <code>(我的理解)</code> 就是从原数组开始复制的结束下标</p>
<p>当第一个参数和第二个参数对应的下标相同时, 无论第三个参数是啥, 返回的都是原数组</p>
<p>当第二个参数和第三个参数相等时, 返回的都是原数组</p>
<p>当第二个参数为正数 <code>(大于数组长度变成0)</code></p>
<ol>
<li><p>当第三个参数为正数时, </p>
<ol>
<li>如果第三个参数值大于数组长度则会变成数组长度</li>
<li>当 <code>end &gt; start</code>时 <code>复制的区域为[start, end)</code> </li>
<li><code>end - start</code>的值小于 <code>数组length - target</code>的值时 会把<code>[start, end)</code> 内复制  </li>
<li>当<code>end &lt;= start</code>时 返回原数组</li>
</ol>
</li>
<li><p>当第三个参数为负数</p>
<ol>
<li>如果第三个参数值绝对值大于数组长度则会变成数组长度</li>
<li>当 <code>数组length + end &gt; start</code>时, <code>复制的区域为[start, end + 数组length)</code> </li>
<li><code>lenghth + end - start</code>的值小于 <code>数组length - target</code>的值时 会把<code>[start, end + 数组length)</code> 内的值复制,</li>
<li>当<code>end + 数组length &lt;= start</code>时 返回原数组</li>
</ol>
</li>
</ol>
<p>当第二个参数为负数时<code>(绝对值大于数组长度变成0)</code></p>
<p>ps: <code>总结还有逻辑问题</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">3</span>, <span class="number">3</span>, <span class="number">-1</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">-1</span>); <span class="comment">// [1, 4, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>); <span class="comment">// [1, 4, 5, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>); <span class="comment">// [1, 4, 5, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>); <span class="comment">// [1, 4, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">-6</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">-5</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">-4</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">-3</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">-2</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">3</span>, <span class="number">-1</span>); <span class="comment">// [1, 4, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-2</span>, <span class="number">4</span>); <span class="comment">// [1, 4, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-2</span>, <span class="number">3</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>传入的参数不是整数的时候</p>
<p>第一个参数被传入小数时, 都会被舍弃掉小数位  <strong>这里主要是如果是正小数行为同 <code>Math.floor</code>, 但是如果是负小数行为等同于 <code>Math.ceil</code></strong>, 但是当小数位数达到足够多的时候比如 <code>2.9999999999999999</code> 时 会被当做 <code>3</code> 而  <code>-3.9999999999999999</code> 会被当做 <code>-4</code> 我觉得可能和存储有关</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.1</span>); <span class="comment">// [1, 1, 2, 3 ,4]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.9</span>); <span class="comment">// [1, 1, 2, 3 ,4]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">-1.9</span>); <span class="comment">// [1, 2, 3, 4, 1]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">-1.1</span>); <span class="comment">// [1, 2, 3, 4, 1]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">2.9999999999999999</span>); <span class="comment">// [1, 2, 3, 1, 2]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">-3.9999999999999999</span>); <span class="comment">// [1, 1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>

<p>第二个参数也传入的是小数时, 行为同第一个参数, 变成整数 同传整数的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.1</span>, <span class="number">2.1</span>); <span class="comment">// [1, 3, 4, 5, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.1</span>, <span class="number">2.9</span>); <span class="comment">// [1, 3, 4, 5, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.1</span>, <span class="number">2.9999999999999999</span>); <span class="comment">// [1, 4, 5, 4, 5] </span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.1</span>, <span class="number">-2.9999999999999999</span>); <span class="comment">// [1, 3, 4, 5, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-2.9</span>); <span class="comment">// [1, 4, 5, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-2.1</span>); <span class="comment">// [1, 4, 5, 4, 5]</span></span><br></pre></td></tr></table></figure>

<p>第三个传的也是小数, 同上</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.1</span>, <span class="number">2.9</span>, <span class="number">4.1</span>); <span class="comment">// [1, 3, 4, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.1</span>, <span class="number">2.9</span>, <span class="number">4.9999999999999999</span>); <span class="comment">// [1, 3, 4, 5, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.1</span>, <span class="number">2.9</span>, <span class="number">4.9</span>); <span class="comment">//  [1, 3, 4, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1.1</span>, <span class="number">-2.9</span>, <span class="number">-4.9999999999999999</span>); <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-3.9</span>, <span class="number">-1.1</span>); <span class="comment">// [1, 3, 4, 4, 5]</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="number">-3.9</span>, <span class="number">-1.9</span>); <span class="comment">// [1, 3, 4, 4, 5]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>传入的字符串, 能通过 <code>parseInt</code>方法返回数字的 字符串能传入, 返回NaN的则按默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">1</span>, <span class="string">"1.9999999999999999xxx"</span>, <span class="number">4</span>); <span class="comment">// [1, 1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><code>fill()</code> 方法可以向一个已有的数组中插入全部或部分相同的值。开始索引用于指定开始填充的位置，它是可选的。如果不提供结束索引，则一直填充到数组末尾, 负值索引从数组末尾开始计算, 也可以将负索引想象成数组长度加上它得到的一个正索引, 会改变原数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>];</span><br><span class="line">arr.fill(<span class="number">1</span>); <span class="comment">// [1, 1, 1, 1, 1]</span></span><br><span class="line"><span class="comment">// 下标大于3的 都会被填充</span></span><br><span class="line">arr.fill(<span class="number">6</span>, <span class="number">3</span>); <span class="comment">// [1, 1, 1, 6, 6]</span></span><br><span class="line">arr.fill(<span class="number">7</span>, <span class="number">2</span>, <span class="number">4</span>); <span class="comment">// [1, 1, 7, 7, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>];</span><br><span class="line">arr.fill(&#123;<span class="attr">name</span>: <span class="string">"decade"</span>&#125;); <span class="comment">// [&#123;name: "decade"&#125;, &#123;name: "decade"&#125;, &#123;name: "decade"&#125;, &#123;name: "decade"&#125;, &#123;name: "decade"&#125;]</span></span><br><span class="line">arr[<span class="number">0</span>].name = <span class="string">"DECADE"</span>; <span class="comment">// [&#123;name: "DECADE"&#125;, &#123;name: "DECADE"&#125;, &#123;name: "DECADE"&#125;, &#123;name: "DECADE"&#125;, &#123;name: "DECADE"&#125;]</span></span><br></pre></td></tr></table></figure>

<p><code>fill</code> 填充对象, 将会都会指向同一个地址</p>
<h4 id="栈方法"><a href="#栈方法" class="headerlink" title="栈方法"></a>栈方法</h4><p><code>push()</code>方法接收任意数量的参数，并将它们添加到数组末尾，返回数组的最新长度,  <strong>改变原数组</strong></p>
<p><code>pop()</code>方法则用于删除数组的最后一项，同时减少数组的 length 值，返回被删除的项  <strong>改变原数组</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [];</span><br><span class="line">arr.push(<span class="string">"a"</span>); <span class="comment">// 1</span></span><br><span class="line">arr.push(<span class="string">"c"</span>); <span class="comment">// 2</span></span><br><span class="line">arr.pop(); <span class="comment">// "c"</span></span><br><span class="line">arr.push(...[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>

<h4 id="队列方法"><a href="#队列方法" class="headerlink" title="队列方法"></a>队列方法</h4><p><code>shift()</code> 删除数组的第一项并返回它, 然后数组长度减 1   <strong>改变原数组</strong></p>
<p><code>unshift()</code> 在数组开头添加任意多个值，然后返回新的数组长度     <strong>改变原数组</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [];</span><br><span class="line">arr.unshift(...[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]); <span class="comment">// 4</span></span><br><span class="line">arr.unshift(<span class="string">"a"</span>); <span class="comment">// 5</span></span><br><span class="line">arr.shift(); <span class="comment">// "a"</span></span><br></pre></td></tr></table></figure>

<h4 id="排序方法"><a href="#排序方法" class="headerlink" title="排序方法"></a>排序方法</h4><p><code>reverse()</code> 让数组内元素 倒过来  <strong>改变原数组</strong></p>
<p><code>sort()</code> 默认情况下，sort()会按照升序重新排列数组元素，即最小的值在前面，最大的值在后面。为此，sort()会在每一项上调用 String()转型函数，然后比较字符串来决定顺序, 另外可以接收一个比较函数, 比较函数接收两个参数，如果第一个参数应该排在第二个参数前面，就返回负值；如果两个参数相等，就返回 0；如果第一个参数应该排在第二个参数后面，就返回正值  <strong>改变原数组</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span> ,<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"A"</span>];</span><br><span class="line">arr.reverse(); <span class="comment">// ["A", "b", "a", 5, 4, 3, 2, 1]</span></span><br><span class="line">arr.sort(); <span class="comment">// [1, 2, 3, 4, 5, "A", "a", "b"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line">arr1.sort(); <span class="comment">// [1, 10, 2, 20, 3, 30, 4, 40, 5, 50]</span></span><br><span class="line">arr1.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a - b;</span><br><span class="line">&#125;); <span class="comment">//  [1, 2, 3, 4, 5, 10, 20, 30, 40, 50]</span></span><br></pre></td></tr></table></figure>

<h4 id="操作方法"><a href="#操作方法" class="headerlink" title="操作方法"></a>操作方法</h4><p><code>concat()</code>方法可以在现有数组全部元素基础上创建一个新数组如果传入一个或多个数组，则 concat()会把这些数组的每一项都添加到结果数组。如果参数不是数组，则直接把它们添加到结果数组末尾  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> arr1 = arr.concat(<span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]); <span class="comment">// [1, 2, 3, 4]</span></span><br><span class="line"><span class="keyword">let</span> arr2 = arr.concat();</span><br><span class="line"><span class="built_in">console</span>.log(arr === arr2); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>打平数组参数的行为可以重写，方法是在参数数组上指定一个特殊的符号：<code>Symbol.isConcatSpreadable</code>。这个符号能够阻止 <code>concat()</code>打平参数数组。相反，把这个值设置为 true 可以强制打平类数组对象</p>
<p><code>slice()</code> 用于创建一个包含原有数组中一个或多个元素的新数组, 该方法接收一个或者两个参数, 开始位置, 结束位置, 只有一个参数的时候, 第二个参数默认为数组末尾, 如果参数为负数, 则用这个<code>负数+数组长度</code>转换为正的, 如果只有一个参数, 且负数的绝对值大于数组长度, 则会变成0, 同理第二个参数绝对值超过数组长度, 会变成数组长度</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colorArr = [<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"pink"</span>, <span class="string">"blue"</span>, <span class="string">"black"</span>, <span class="string">"white"</span>];</span><br><span class="line">colorArr.slice(); <span class="comment">// ["red", "green", "yellow", "pink", "blue", "black", "white"]</span></span><br><span class="line">colorArr.slice(<span class="number">2</span>); <span class="comment">// ["yellow", "pink", "blue", "black", "white"]</span></span><br><span class="line">colorArr.slice(<span class="number">2</span>, <span class="number">4</span>); <span class="comment">// ["yellow", "pink"]</span></span><br></pre></td></tr></table></figure>

<p><code>splice()</code> 方法始终返回这样一个数组，它包含从数组中被删除的元素(如果没有删除元素，则返回空数组)  <strong>改变原数组</strong></p>
<ul>
<li>删除  需要给 splice()传 2 个参数：要删除的第一个元素的位置和要删除的元素数量。可以从数组中删除任意多个元素</li>
<li>插入  需要给 splice()传 3 个参数：开始位置、0（要删除的元素数量）和要插入的元素，可以在数组中指定的位置插入元素。第三个参数之后还可以传第四个、第五个参数，乃至任意多个要插入的元素</li>
<li>替换  splice()在删除元素的同时可以在指定位置插入新元素，同样要传入 3 个参数：开始位置、要删除元素的数量和要插入的任意多个元素。要插入的元素数量不一定跟删除的元素数量一致</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> removeArr = arr.splice(<span class="number">0</span>, <span class="number">1</span>); <span class="comment">// 删除第一项</span></span><br><span class="line"><span class="built_in">console</span>.log(removeArr); <span class="comment">// [1];</span></span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// [2, 3, 4]</span></span><br><span class="line">arr.splice(<span class="number">0</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// [2, 3, 4, 5, 6]</span></span><br><span class="line"><span class="keyword">let</span> removedArr2 = arr.splice(<span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">8</span>);</span><br><span class="line"><span class="built_in">console</span>.log(removedArr2); <span class="comment">// [2]</span></span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// [7. 8, 3, 4, 5, 6]</span></span><br></pre></td></tr></table></figure>

<h4 id="搜索和位置方法"><a href="#搜索和位置方法" class="headerlink" title="搜索和位置方法"></a>搜索和位置方法</h4><p>ECMAScript 提供两类搜索数组的方法：按严格相等搜索和按断言函数搜索</p>
<h5 id="按严格相等搜索"><a href="#按严格相等搜索" class="headerlink" title="按严格相等搜索"></a>按严格相等搜索</h5><p><code>indexOf()</code> 接收两个参数, 待查找的元素和检索开始的索引,  找到便返回元素的索引,否则返回<code>-1</code></p>
<p><code>lastIndexOf()</code> 接收两个参数, 待查找的元素和检索开始的索引, 找到便返回元素的索引,否则返回<code>-1</code></p>
<p><code>includes()</code>  接收一个参数, 待查找的元素, 找到返回 <code>true</code> 找不到 返回 <code>false</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>];</span><br><span class="line">arr.indexOf(<span class="number">1</span>); <span class="comment">// 1</span></span><br><span class="line">arr.indexOf(<span class="string">"1"</span>); <span class="comment">// -1</span></span><br><span class="line">arr.indexOf(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 4</span></span><br><span class="line">arr.lastIndexOf(<span class="number">1</span>); <span class="comment">// 4</span></span><br><span class="line">arr.lastIndexOf(<span class="string">"-1"</span>); <span class="comment">// -1</span></span><br><span class="line">arr.lastIndexOf(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 1</span></span><br><span class="line">arr.includes(<span class="number">1</span>); <span class="comment">// true</span></span><br><span class="line">arr.includes(<span class="string">"1"</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<h5 id="断言函数"><a href="#断言函数" class="headerlink" title="断言函数"></a>断言函数</h5><p>断言函数接收 3 个参数：元素、索引和数组本身。其中元素是数组中当前搜索的元素，索引是当前元素的索引，而数组就是正在搜索的数组。断言函数返回真值，表示是否匹配</p>
<p><code>find()</code>和 <code>findIndex()</code>方法使用了断言函数。这两个方法都从数组的最小索引开始。find()返回第一个匹配的元素，findIndex()返回第一个匹配元素的索引。这两个方法也都接收第二个可选的参数，用于指定断言函数内部 this 的值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> item = arr.find(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(item); <span class="comment">// 2</span></span><br><span class="line"><span class="keyword">let</span> index = arr.findIndex(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(index); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">item = arr.find((<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> value &gt; <span class="keyword">this</span>.count</span><br><span class="line">&#125;), &#123;<span class="attr">count</span>: <span class="number">2</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(item); <span class="comment">// 2 箭头函数不行</span></span><br></pre></td></tr></table></figure>

<h4 id="迭代方法"><a href="#迭代方法" class="headerlink" title="迭代方法"></a>迭代方法</h4><p>ECMAScript 为数组定义了 5 个迭代方法。每个方法接收两个参数：以每一项为参数运行的函数，以及可选的作为函数运行上下文的作用域对象（影响函数中 this 的值）。传给每个方法的函数接收 3个参数：数组元素、元素索引和数组本身</p>
<p><code>every()</code> 数组每一项传入函数,如果所有项都让函数返回<code>true</code>, 该方法返回<code>true</code> 否则返回 <code>false</code></p>
<p><code>filter()</code> 数组每一项传入函数, 返回使函数返回<code>true</code>的项拼装的数组</p>
<p><code>forEach()</code> 数组每一项传入函数, 没有返回值</p>
<p><code>map()</code> 数组每一项传入函数, 返回由每次函数调用的结果构成的数组</p>
<p><code>some()</code> 数组每一项传入函数, 只要有一项让函数返回 <code>true</code>, 该方法返回<code>true</code>, 否则返回 <code>false</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> forEachResult = arr.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item);</span><br><span class="line">    <span class="keyword">return</span> item;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(forEachResult); <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> mapResult = arr.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(mapResult); <span class="comment">// [undefined, undefined, undefined, undefined, undefined] </span></span><br><span class="line">mapResult = arr.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item ** <span class="number">2</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(mapResult); <span class="comment">// [1, 4, 9, 16, 25] </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> everyResult = arr.every(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">2</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(everyResult); <span class="comment">// false  </span></span><br><span class="line">everyResult = arr.every(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">0</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(everyResult); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> filterResult = arr.filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">2</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(filterResult); <span class="comment">// [3, 4, 5]</span></span><br><span class="line">filterResult = arr.filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">5</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(filterResult); <span class="comment">// []</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> someResult = arr.some(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">4</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(someResult); <span class="comment">// true</span></span><br><span class="line">someResult = arr.some(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">5</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(someResult); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<h4 id="归并方法"><a href="#归并方法" class="headerlink" title="归并方法"></a>归并方法</h4><p>ECMAScript 为数组提供了两个归并方法：reduce()和 reduceRight()。这两个方法都会迭代数组的所有项，并在此基础上构建一个最终返回值。reduce()方法从数组第一项开始遍历到最后一项, 而 reduceRight()从最后一项开始遍历至第一项</p>
<p>这两个方法都接收两个参数, 第一个参数是一个函数, 函数的形参有四个(上一次归并值, 当前项, 当前项的索引, 数组本身), 第二个参数为归并起点的初始值, 如果没有传入第二个参数, 则默认数组的第一项为初始值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> sum = arr.reduce(<span class="function">(<span class="params">prev, curr, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line"> 	<span class="built_in">console</span>.log(prev, curr, index, arr);</span><br><span class="line">    <span class="keyword">return</span> prev + curr;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 1 2 1 [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 3 3 2 [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 6 4 3 [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 10 5 4 [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="built_in">console</span>.log(sum); <span class="comment">// 15</span></span><br><span class="line"></span><br><span class="line">sum = arr.reduce(<span class="function">(<span class="params">prev, curr, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line"> 	<span class="built_in">console</span>.log(prev, curr, index, arr);</span><br><span class="line">    <span class="keyword">return</span> prev + curr;</span><br><span class="line">&#125;, <span class="number">15</span>);</span><br><span class="line"><span class="comment">// 15 1 0 [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 16 2 1 [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 18 3 2 [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 21 4 3 [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment">// 25 5 4 [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="built_in">console</span>.log(sum); <span class="comment">// 30</span></span><br></pre></td></tr></table></figure>

<h3 id="定型数组"><a href="#定型数组" class="headerlink" title="定型数组"></a>定型数组</h3><p>定型数组（typed array）是 ECMAScript 新增的结构，目的是提升向原生库传输数据的效率, 实际上, JavaScript 并没有“TypedArray”类型，它所指的其实是一种特殊的包含数值类型的数组</p>
<h4 id="ArrayBuffer"><a href="#ArrayBuffer" class="headerlink" title="ArrayBuffer"></a>ArrayBuffer</h4><p>Float32Array 实际上是一种“视图”，可以允许 JavaScript 运行时访问一块名为 ArrayBuffer 的预分配内存, ArrayBuffer 是所有定型数组及视图引用的基本单位ArrayBuffer()是一个普通的 JavaScript 构造函数，可用于在内存中分配特定数量的字节空间, ArrayBuffer 一经创建就不能再调整大小。不过，可以使用 slice()复制其全部或部分到一个新实例中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">16</span>); <span class="comment">// 分配16个字节</span></span><br><span class="line"><span class="keyword">let</span> buffer1 = buffer.slice(<span class="number">2</span>); <span class="comment">// 14个字节</span></span><br></pre></td></tr></table></figure>

<p>ArrayBuffer 某种程度上类似于 C++的 malloc()，但也有几个明显的区别</p>
<ul>
<li><code>malloc()</code>在分配失败时会返回一个 null 指针,  <code>ArrayBuffer</code> 在分配失败时会抛出错误</li>
<li><code>malloc()</code>可以利用虚拟内存，因此最大可分配尺寸只受可寻址系统内存限制, <code>ArrayBuffer</code>分配的内存不能超过 <code>Number.MAX_SAFE_INTEGER（2^53 - 1）</code>字节</li>
<li><code>malloc()</code>调用成功不会初始化实际的地址, 声明 <code>ArrayBuffer</code> 则会将所有二进制位初始化为 0</li>
<li>1malloc()1分配的堆内存除非调用 free()或程序退出，否则系统不能再使用, 而通过声明<code>ArrayBuffer</code> 分配的堆内存可以被当成垃圾回收，不用手动释放</li>
</ul>
<p>不能仅通过对 ArrayBuffer 的引用就读取或写入其内容。要读取或写入 ArrayBuffer，就必须通过视图, 视图有不同的类型，但引用的都是 ArrayBuffer 中存储的二进制数据</p>
<h4 id="DataView"><a href="#DataView" class="headerlink" title="DataView"></a>DataView</h4><p>第一种允许你读写 ArrayBuffer 的视图是 DataView, 这个视图专为文件 I/O 和网络 I/O 设计，其API 支持对缓冲数据的高度控制，但相比于其他类型的视图性能也差一些, DataView 对缓冲内容没有任何预设，也不能迭代</p>
<p>必须在对已有的 ArrayBuffer 读取或写入时才能创建 DataView 实例。这个实例可以使用全部或部分 ArrayBuffer，且维护着对该缓冲实例的引用，以及视图在缓冲中开始的位置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// DataView 默认使用整个 ArrayBuffer </span></span><br><span class="line"><span class="keyword">const</span> fullDataView = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer); <span class="comment">// buffer: ArrayBuffer(16) byteLength: 16  byteOffset: 0 </span></span><br><span class="line"><span class="built_in">console</span>.log(fullDataView.byteOffset); <span class="comment">// 0 </span></span><br><span class="line"><span class="built_in">console</span>.log(fullDataView.byteLength); <span class="comment">// 16 </span></span><br><span class="line"><span class="built_in">console</span>.log(fullDataView.buffer === buffer); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造函数接收一个可选的字节偏移量和字节长度</span></span><br><span class="line"><span class="comment">// byteOffset=0 表示视图从缓冲起点开始</span></span><br><span class="line"><span class="comment">// byteLength=8 限制视图为前 8 个字节</span></span><br><span class="line"><span class="keyword">const</span> firstHalfDataView = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer, <span class="number">0</span>, <span class="number">8</span>); </span><br><span class="line"><span class="built_in">console</span>.log(firstHalfDataView.byteOffset); <span class="comment">// 0 </span></span><br><span class="line"><span class="built_in">console</span>.log(firstHalfDataView.byteLength); <span class="comment">// 8 </span></span><br><span class="line"><span class="built_in">console</span>.log(firstHalfDataView.buffer === buffer); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果不指定，则 DataView 会使用剩余的缓冲</span></span><br><span class="line"><span class="comment">// byteOffset=8 表示视图从缓冲的第 9 个字节开始</span></span><br><span class="line"><span class="comment">// byteLength 未指定，默认为剩余缓冲</span></span><br><span class="line"><span class="keyword">const</span> secondHalfDataView = <span class="keyword">new</span> <span class="built_in">DataView</span>(buffer, <span class="number">8</span>); </span><br><span class="line"><span class="built_in">console</span>.log(secondHalfDataView.byteOffset); <span class="comment">// 8</span></span><br><span class="line"><span class="built_in">console</span>.log(secondHalfDataView.byteLength); <span class="comment">// 8 </span></span><br><span class="line"><span class="built_in">console</span>.log(secondHalfDataView.buffer === buffer); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>要通过 DataView 读取缓冲，还需要几个组件</p>
<ul>
<li>首先是要读或写的字节偏移量, 可以看成 DataView 中的某种””地址”</li>
<li>DataView 应该使用 ElementType 来实现 JavaScript 的 Number 类型到缓冲内二进制格式的转换</li>
<li>最后是内存中值的字节序。默认为大端字节序</li>
</ul>
<h5 id="ElementType"><a href="#ElementType" class="headerlink" title="ElementType"></a>ElementType</h5><p>DataView 对存储在缓冲内的数据类型没有预设, 它暴露的 API 强制开发者在读、写时指定一个ElementType，然后 DataView 就会忠实地为读、写而完成相应的转换</p>
<table>
<thead>
<tr>
<th align="center">ElementType</th>
<th align="center">字节</th>
<th align="center">说明</th>
<th align="center">等价C类型</th>
<th align="center">值的范围</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Int8</td>
<td align="center">1</td>
<td align="center">8 位有符号整数</td>
<td align="center">signed char</td>
<td align="center">-128~127</td>
</tr>
<tr>
<td align="center">Uint8</td>
<td align="center">1</td>
<td align="center">8 位无符号整数</td>
<td align="center">unsigned char</td>
<td align="center">0~255</td>
</tr>
<tr>
<td align="center">Int16</td>
<td align="center">2</td>
<td align="center">16 位有符号整数</td>
<td align="center">short</td>
<td align="center">-32 768~32 767</td>
</tr>
<tr>
<td align="center">Uint16</td>
<td align="center">2</td>
<td align="center">16 位无符号整数</td>
<td align="center">unsigned short</td>
<td align="center">0~65 535</td>
</tr>
<tr>
<td align="center">Int32</td>
<td align="center">4</td>
<td align="center">32 位有符号整数</td>
<td align="center">int</td>
<td align="center">-2 147 483 648~2 147 483 647</td>
</tr>
<tr>
<td align="center">Uint32</td>
<td align="center">4</td>
<td align="center">32 位无符号整数</td>
<td align="center">unsigned int</td>
<td align="center">0~4 294 967 295</td>
</tr>
<tr>
<td align="center">Float32</td>
<td align="center">4</td>
<td align="center">32 位 IEEE-754 浮点数</td>
<td align="center">float</td>
<td align="center">-3.4e+38~+3.4e+38</td>
</tr>
<tr>
<td align="center">Float64</td>
<td align="center">8</td>
<td align="center">64 位 IEEE-754 浮点数</td>
<td align="center">double</td>
<td align="center">-1.7e+308~+1.7e+308</td>
</tr>
</tbody></table>
<p>DataView 为上表中的每种类型都暴露了 get 和 set 方法，这些方法使用 byteOffset (字节偏移量) 定位要读取或写入值的位置, 类型是可以互换使用的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> buff = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">16</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	[[Int8Array]]: Int8Array(16) [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	[[Int16Array]]: Int16Array(8) [0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	[[Int32Array]]: Int32Array(4) [0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	[[Uint8Array]]: Uint8Array(16) [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	byteLength: 16</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buff);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	buffer: ArrayBuffer(16)</span></span><br><span class="line"><span class="comment">	byteLength: 16</span></span><br><span class="line"><span class="comment">	byteOffset: 0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 说明整个缓冲确实所有二进制位都是 0 </span></span><br><span class="line"><span class="comment">// 检查第一个和第二个字符</span></span><br><span class="line">view.getInt8(<span class="number">0</span>); <span class="comment">// 0 </span></span><br><span class="line">view.getInt8(<span class="number">1</span>); <span class="comment">// 0 </span></span><br><span class="line"><span class="comment">// 检查整个缓冲</span></span><br><span class="line">view.getInt16(<span class="number">0</span>); <span class="comment">// 0 </span></span><br><span class="line"><span class="comment">// 将整个缓冲都设置为 1 </span></span><br><span class="line"><span class="comment">// 255 的二进制表示是 11111111（2^8 - 1）</span></span><br><span class="line">view.setUint8(<span class="number">0</span>, <span class="number">255</span>); </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	[[Int8Array]]: Int8Array(16) [-1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	[[Int16Array]]: Int16Array(8) [255, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	[[Int32Array]]: Int32Array(4) [255, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	[[Uint8Array]]: Uint8Array(16) [255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// DataView 会自动将数据转换为特定的 ElementType </span></span><br><span class="line"><span class="comment">// 255 的十六进制表示是 0xFF </span></span><br><span class="line">view.setUint8(<span class="number">1</span>, <span class="number">0xFF</span>); </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	[[Int8Array]]: Int8Array(16) [-1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	[[Int16Array]]: Int16Array(8) [-1, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	[[Int32Array]]: Int32Array(4) [65535, 0, 0, 0]</span></span><br><span class="line"><span class="comment">	[[Uint8Array]]: Uint8Array(16) [255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// 现在，缓冲里都是 1 了</span></span><br><span class="line"><span class="comment">// 如果把它当成二补数的有符号整数，则应该是-1 </span></span><br><span class="line">view.getInt16(<span class="number">0</span>); <span class="comment">// -1</span></span><br></pre></td></tr></table></figure>

<h5 id="字节序"><a href="#字节序" class="headerlink" title="字节序"></a>字节序</h5><p>指的是计算系统维护的一种字节顺序的约定。DataView 只支持两种约定：大端字节序和小端字节序。大端字节序也称为“网络字节序”，意思是最高有效位保存在第一个字节，而最低有效位保存在最后一个字节。小端字节序正好相反，即最低有效位保存在第一个字节，最高有效位保存在最后一个字节。</p>
<p>DataView 的所有 API 方法都以大端字节序作为默认值，但接收一个可选的布尔值参数，设置为 true 即可启用小端字节序</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在内存中分配两个字节并声明一个 DataView </span></span><br><span class="line"><span class="keyword">const</span> buf = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">2</span>); </span><br><span class="line"><span class="keyword">const</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buf); </span><br><span class="line"><span class="comment">// 填充缓冲，让第一位和最后一位都是 1 </span></span><br><span class="line">view.setUint8(<span class="number">0</span>, <span class="number">0x80</span>); <span class="comment">// 设置最左边的位等于 1 </span></span><br><span class="line">view.setUint8(<span class="number">1</span>, <span class="number">0x01</span>); <span class="comment">// 设置最右边的位等于 1 </span></span><br><span class="line"><span class="comment">// 缓冲内容（为方便阅读，人为加了空格）</span></span><br><span class="line"><span class="comment">// 0x8 0x0 0x0 0x1 </span></span><br><span class="line"><span class="comment">// 1000 0000 0000 0001 </span></span><br><span class="line"><span class="comment">// 按大端字节序读取 Uint16 </span></span><br><span class="line"><span class="comment">// 0x80 是高字节，0x01 是低字节</span></span><br><span class="line"><span class="comment">// 0x8001 = 2^15 + 2^0 = 32768 + 1 = 32769 </span></span><br><span class="line">view.getUint16(<span class="number">0</span>); <span class="comment">// 32769 </span></span><br><span class="line"><span class="comment">// 按小端字节序读取 Uint16 </span></span><br><span class="line"><span class="comment">// 0x01 是高字节，0x80 是低字节</span></span><br><span class="line"><span class="comment">// 0x0180 = 2^8 + 2^7 = 256 + 128 = 384 </span></span><br><span class="line">view.getUint16(<span class="number">0</span>, <span class="literal">true</span>); <span class="comment">// 384 </span></span><br><span class="line"><span class="comment">// 按大端字节序写入 Uint16 </span></span><br><span class="line">view.setUint16(<span class="number">0</span>, <span class="number">0x0004</span>); </span><br><span class="line"><span class="comment">// 缓冲内容（为方便阅读，人为加了空格）</span></span><br><span class="line"><span class="comment">// 0x0 0x0 0x0 0x4 </span></span><br><span class="line"><span class="comment">// 0000 0000 0000 0100 </span></span><br><span class="line">view.getUint8(<span class="number">0</span>); <span class="comment">// 0 </span></span><br><span class="line">view.getUint8(<span class="number">1</span>); <span class="comment">// 4 </span></span><br><span class="line"><span class="comment">// 按小端字节序写入 Uint16 </span></span><br><span class="line">view.setUint16(<span class="number">0</span>, <span class="number">0x0002</span>, <span class="literal">true</span>); </span><br><span class="line"><span class="comment">// 缓冲内容（为方便阅读，人为加了空格）</span></span><br><span class="line"><span class="comment">// 0x0 0x2 0x0 0x0 </span></span><br><span class="line"><span class="comment">// 0000 0010 0000 0000 </span></span><br><span class="line">view.getUint8(<span class="number">0</span>); <span class="comment">// 2 </span></span><br><span class="line">view.getUint8(<span class="number">1</span>); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>

<h5 id="边界情况"><a href="#边界情况" class="headerlink" title="边界情况"></a>边界情况</h5><p>DataView 完成读、写操作的前提是必须有充足的缓冲区，否则就会抛出 RangeError</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> buf = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">6</span>); </span><br><span class="line"><span class="keyword">const</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buf); </span><br><span class="line"><span class="comment">// 尝试读取部分超出缓冲范围的值</span></span><br><span class="line">view.getInt32(<span class="number">4</span>); </span><br><span class="line"><span class="comment">// RangeError </span></span><br><span class="line"><span class="comment">// 尝试读取超出缓冲范围的值</span></span><br><span class="line">view.getInt32(<span class="number">8</span>); </span><br><span class="line"><span class="comment">// RangeError </span></span><br><span class="line"><span class="comment">// 尝试读取超出缓冲范围的值</span></span><br><span class="line">view.getInt32(<span class="number">-1</span>); </span><br><span class="line"><span class="comment">// RangeError </span></span><br><span class="line"><span class="comment">// 尝试写入超出缓冲范围的值</span></span><br><span class="line">view.setInt32(<span class="number">4</span>, <span class="number">123</span>); </span><br><span class="line"><span class="comment">// RangeError</span></span><br></pre></td></tr></table></figure>

<p>DataView 在写入缓冲里会尽最大努力把一个值转换为适当的类型，后备为 0。如果无法转换，则抛出错误</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> buf = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">1</span>); </span><br><span class="line"><span class="keyword">const</span> view = <span class="keyword">new</span> <span class="built_in">DataView</span>(buf); </span><br><span class="line">view.setInt8(<span class="number">0</span>, <span class="number">1.5</span>); </span><br><span class="line">alert(view.getInt8(<span class="number">0</span>)); <span class="comment">// 1 </span></span><br><span class="line">view.setInt8(<span class="number">0</span>, [<span class="number">4</span>]); </span><br><span class="line">alert(view.getInt8(<span class="number">0</span>)); <span class="comment">// 4 </span></span><br><span class="line">view.setInt8(<span class="number">0</span>, <span class="string">'f'</span>); </span><br><span class="line">alert(view.getInt8(<span class="number">0</span>)); <span class="comment">// 0 </span></span><br><span class="line">view.setInt8(<span class="number">0</span>, <span class="built_in">Symbol</span>()); </span><br><span class="line"><span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure>

<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p>Map 是一种新的集合类型，为这门语言带来了真正的键/值存储机制</p>
<h4 id="基本API"><a href="#基本API" class="headerlink" title="基本API"></a>基本API</h4><p>使用 new 关键字和 Map 构造函数可以创建一个空映射</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个空映射</span></span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果想在创建的同时初始化实例，可以给 Map 构造函数传入一个可迭代对象，需要包含键/值对数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用嵌套数组初始化映射</span></span><br><span class="line"><span class="keyword">const</span> map1 = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="string">"name"</span>, <span class="string">"decade"</span>], [<span class="string">"age"</span>, <span class="number">20</span>], [<span class="string">"like"</span>, <span class="string">"code"</span>]]);</span><br><span class="line">map1.size; <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用自定义迭代器初始化映射</span></span><br><span class="line"><span class="keyword">const</span> map2 = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span><br><span class="line">    [<span class="built_in">Symbol</span>.iterator]: <span class="function"><span class="keyword">function</span> * (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">yield</span> [<span class="string">"name"</span>, <span class="string">"decade"</span>];</span><br><span class="line">        <span class="keyword">yield</span> [<span class="string">"age"</span>, <span class="number">20</span>];</span><br><span class="line">        <span class="keyword">yield</span> [<span class="string">"like"</span>, <span class="string">"code"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">map2.size; <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 映射期待的键/值对，无论是否提供</span></span><br><span class="line"><span class="keyword">const</span> map3 = <span class="keyword">new</span> <span class="built_in">Map</span>([]);</span><br><span class="line">map3.has(<span class="literal">undefined</span>); <span class="comment">// true</span></span><br><span class="line">map3.get(<span class="literal">undefined</span>); <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化之后，可以使用 set()方法再添加键/值对。另外，可以使用 get()和 has()进行查询，可以通过 size 属性获取映射中的键/值对的数量，还可以使用 delete()和 clear()删除值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> map4 = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">map4.has(<span class="string">"name"</span>); <span class="comment">// false</span></span><br><span class="line">map4.has(<span class="literal">undefined</span>); <span class="comment">// false</span></span><br><span class="line">map4.delete(<span class="string">"age"</span>); <span class="comment">// false</span></span><br><span class="line">map4.size; <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line">map4.set(<span class="string">"name"</span>, <span class="string">"decade"</span>).set(<span class="string">"age"</span>, <span class="number">20</span>);</span><br><span class="line">map4.has(<span class="string">"name"</span>); <span class="comment">// true;</span></span><br><span class="line">map4.get(<span class="string">"age"</span>); <span class="comment">// 20</span></span><br><span class="line">map4.size; <span class="comment">// 2</span></span><br><span class="line">map4.delete(<span class="string">"name"</span>); <span class="comment">// true</span></span><br><span class="line">map4.size; <span class="comment">// 1</span></span><br><span class="line">map4.clear(); </span><br><span class="line">map4.size; <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>

<p>与 Object 只能使用数值、字符串或符号作为键不同，Map 可以使用任何 JavaScript 数据类型作为键, Map 内部使用 SameValueZero 比较操作 基本上相当于使用严格对象相等的标准来检查键的匹配性, 与 Object 类似，映射的值是没有限制的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>(); </span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> functionKey = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;; </span><br><span class="line"><span class="keyword">const</span> symbolKey = <span class="built_in">Symbol</span>(); </span><br><span class="line"><span class="keyword">const</span> objectKey = <span class="keyword">new</span> <span class="built_in">Object</span>(); </span><br><span class="line"></span><br><span class="line">m.set(functionKey, <span class="string">"functionValue"</span>); </span><br><span class="line">m.set(symbolKey, <span class="string">"symbolValue"</span>); </span><br><span class="line">m.set(objectKey, <span class="string">"objectValue"</span>); </span><br><span class="line"></span><br><span class="line">m.get(functionKey); <span class="comment">// functionValue </span></span><br><span class="line">m.get(symbolKey); <span class="comment">// symbolValue </span></span><br><span class="line">m.get(objectKey); <span class="comment">// objectValue</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 地址不一样</span></span><br><span class="line">m.get(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;); <span class="comment">// undefiend;</span></span><br></pre></td></tr></table></figure>

<p>与严格相等一样，在映射中用作键和值的对象及其他“集合”类型，在自己的内容或属性被修改时仍然保持不变</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>(); </span><br><span class="line"><span class="keyword">const</span> objKey = &#123;&#125;, </span><br><span class="line">      objVal = &#123;&#125;, </span><br><span class="line">      arrKey = [], </span><br><span class="line">      arrVal = []; </span><br><span class="line">m.set(objKey, objVal); </span><br><span class="line">m.set(arrKey, arrVal); </span><br><span class="line">objKey.foo = <span class="string">"foo"</span>; </span><br><span class="line">objVal.bar = <span class="string">"bar"</span>; </span><br><span class="line">arrKey.push(<span class="string">"foo"</span>); </span><br><span class="line">arrVal.push(<span class="string">"bar"</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	Map(2) &#123;&#123;…&#125; =&gt; &#123;…&#125;, Array(1) =&gt; Array(1)&#125;</span></span><br><span class="line"><span class="comment">	0: &#123;Object =&gt; Object&#125;</span></span><br><span class="line"><span class="comment">		key: &#123;foo: "foo"&#125;</span></span><br><span class="line"><span class="comment">		value: &#123;bar: "bar"&#125;</span></span><br><span class="line"><span class="comment">	1: &#123;Array(1) =&gt; Array(1)&#125;</span></span><br><span class="line"><span class="comment">		key: ["foo"]</span></span><br><span class="line"><span class="comment">		value: ["bar"]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>SameValueZero 比较也可能导致意想不到的冲突</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>(); </span><br><span class="line"><span class="keyword">const</span> a = <span class="number">0</span>/<span class="string">""</span>, <span class="comment">// NaN </span></span><br><span class="line">      b = <span class="number">0</span>/<span class="string">""</span>, <span class="comment">// NaN </span></span><br><span class="line">      pz = +<span class="number">0</span>,</span><br><span class="line">      nz = <span class="number">-0</span>;</span><br><span class="line">a === b; <span class="comment">// false</span></span><br><span class="line">pz === nz; <span class="comment">// true;</span></span><br><span class="line"></span><br><span class="line">m.set(a, <span class="string">"foo"</span>); </span><br><span class="line">m.set(pz, <span class="string">"bar"</span>);</span><br><span class="line"></span><br><span class="line">m.get(b); <span class="comment">// foo</span></span><br><span class="line">m.get(nz); <span class="comment">// bar</span></span><br></pre></td></tr></table></figure>

<h4 id="顺序与迭代"><a href="#顺序与迭代" class="headerlink" title="顺序与迭代"></a>顺序与迭代</h4><p>与 Object 类型的一个主要差异是，Map 实例会维护键值对的插入顺序，因此可以根据插入顺序执行迭代操作</p>
<p>映射实例可以提供一个迭代器(Iterator), 能以插入顺序生成[key, value]形式的数组; 可以通过 entries()方法 (或者 Symbol.iterator 属性，它引用 entries()) 取得这个迭代器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">    [<span class="string">"name"</span>, <span class="string">"decade"</span>],</span><br><span class="line">    [<span class="string">"age"</span>, <span class="number">20</span>],</span><br><span class="line">    [<span class="string">"like"</span>, <span class="string">"code"</span>]</span><br><span class="line">]);</span><br><span class="line">map.entries === map[<span class="built_in">Symbol</span>.iterator]; <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log([...map]); <span class="comment">// [["name", "decade"], ["age", 20], ["like", "code"]]</span></span><br></pre></td></tr></table></figure>

<h4 id="选择-Object-还是-Map"><a href="#选择-Object-还是-Map" class="headerlink" title="选择 Object 还是 Map"></a>选择 <strong>Object</strong> 还是 Map</h4><p>对于多数 Web 开发任务来说，选择 Object 还是 Map 只是个人偏好问题，影响不大。不过，对于在乎内存和性能的开发者来说，对象和映射之间确实存在显著的差别</p>
<ol>
<li><p>内存占用</p>
<p>Object 和 Map 的工程级实现在不同浏览器间存在明显差异, 但存储单个键/值对所占用的内存数量都会随键的数量线性增加. 批量添加或删除键/值对则取决于各浏览器对该类型内存分配的工程实现. 不同浏览器的情况不同, 但给定固定大小的内存, Map 大约可以比 Object 多存储 50%的键/值对</p>
</li>
<li><p>插入性能</p>
<p>Object 和 Map 中插入新键/值对的消耗大致相当, 不过插入 Map 在所有浏览器中一般会稍微快一点儿. 对这两个类型来说, 插入速度并不会随着键/值对数量而线性增加. 如果代码涉及大量插入操作, 那么显然 Map 的性能更佳</p>
</li>
<li><p>查找速度</p>
<p>与插入不同, 从大型 Object 和 Map 中查找键/值对的性能差异极小, 但如果只包含少量键/值对, 则 Object 有时候速度更快. 在把 Object 当成数组使用的情况下(比如使用连续整数作为属性), 浏览器引擎可以进行优化, 在内存中使用更高效的布局. 这对 Map 来说是不可能的. 对这两个类型而言, 查找速度不会随着键/值对数量增加而线性增加. 如果代码涉及大量查找操作, 那么某些情况下可能选择 Object 更好一些</p>
</li>
<li><p>删除性能</p>
<p>使用 delete 删除 Object 属性的性能一直以来饱受诟病, 目前在很多浏览器中仍然如此. 为此, 出现了一些伪删除对象属性的操作, 包括把属性值设置为 undefined 或 null. 但很多时候, 这都是一种讨厌的或不适宜的折中. 而对大多数浏览器引擎来说, Map 的 delete()操作都比插入和查找更快. 如果代码涉及大量删除操作, 那么毫无疑问应该选择 Map</p>
</li>
</ol>
<h3 id="WeakMap"><a href="#WeakMap" class="headerlink" title="WeakMap"></a>WeakMap</h3><p>ECMAScript 6 新增的 <strong>“弱映射”</strong> (WeakMap)是一种新的集合类型, 为这门语言带来了增强的键/值对存储机制. WeakMap 是 Map 的”兄弟”类型, 其 API 也是 Map 的子集. WeakMap 中的”weak”(弱), 描述的是 JavaScript 垃圾回收程序对待”弱映射”中键的方式</p>
<h4 id="基本API-1"><a href="#基本API-1" class="headerlink" title="基本API"></a>基本API</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以使用 new 关键字实例化一个空的 WeakMap</span></span><br><span class="line"><span class="keyword">const</span> weakMap = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 弱映射中的键只能是 Object 或者继承自 Object 的类型, 尝试使用非对象设置键会抛出TypeError 值的类型没有限制</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果想在初始化时填充弱映射, 则构造函数可以接收一个可迭代对象, 其中需要包含键/值对数组. 可迭代对象中的每个键/值都会按照迭代顺序插入新实例中</span></span><br><span class="line"><span class="keyword">const</span> key1 = &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;,</span><br><span class="line">      key2 = &#123; <span class="attr">id</span>: <span class="number">2</span> &#125;,</span><br><span class="line">      key3 = &#123; <span class="attr">id</span>: <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> wm1 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>([ </span><br><span class="line">    [key1, <span class="string">"val1"</span>], </span><br><span class="line">    [key2, <span class="string">"val2"</span>], </span><br><span class="line">    [key3, <span class="string">"val3"</span>] </span><br><span class="line">]);</span><br><span class="line">wm1.get(key1); <span class="comment">// val1</span></span><br><span class="line">wm1.get(key2); <span class="comment">// val2</span></span><br><span class="line">wm1.get(key3); <span class="comment">// val3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化是全有或全无的操作</span></span><br><span class="line"><span class="comment">// 只要有一个键无效就会抛出错误，导致整个初始化失败</span></span><br><span class="line"><span class="keyword">const</span> wm2 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>([ </span><br><span class="line">    [key1, <span class="string">"val1"</span>], </span><br><span class="line">    [<span class="string">"BADKEY"</span>, <span class="string">"val2"</span>], </span><br><span class="line">    [key3, <span class="string">"val3"</span>] </span><br><span class="line">]); <span class="comment">// TypeError: Invalid value used as WeakMap key </span></span><br><span class="line"><span class="keyword">typeof</span> wm2; <span class="comment">// ReferenceError: wm2 is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原始值可以先包装成对象再用作键</span></span><br><span class="line"><span class="keyword">const</span> stringKey = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">"key1"</span>); </span><br><span class="line"><span class="keyword">const</span> wm3 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>([ </span><br><span class="line">    stringKey, <span class="string">"val1"</span> </span><br><span class="line">]);</span><br><span class="line">wm3.get(stringKey); <span class="comment">// val1</span></span><br></pre></td></tr></table></figure>

<p>初始化之后可以使用 set()再添加键/值对, 可以使用 get()和 has()查询,还可以使用 delete()删除</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"><span class="keyword">const</span> key1 = &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;,</span><br><span class="line">      key2 = &#123; <span class="attr">id</span>: <span class="number">2</span> &#125;;</span><br><span class="line">wm.has(key1); <span class="comment">// false;</span></span><br><span class="line">wm.get(key1); <span class="comment">// undefined</span></span><br><span class="line">wm.set(key1, <span class="string">"val1"</span>).set(key2, <span class="string">"val2"</span>);</span><br><span class="line">wm.has(key1); <span class="comment">// true</span></span><br><span class="line">wm.get(key2); <span class="comment">// val2</span></span><br><span class="line">wm.delete(key1); <span class="comment">// true</span></span><br><span class="line">wm.has(key1); <span class="comment">// false</span></span><br><span class="line">wm.has(key2); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h4 id="弱键"><a href="#弱键" class="headerlink" title="弱键"></a>弱键</h4><p>WeakMap 中 “weak” 表示弱映射的键是 “弱弱地拿着” 的. 意思就是, 这些键不属于正式的引用, 不会阻止垃圾回收. 但要注意的是, 弱映射中值的引用可不是”弱弱地拿着”的, 只要键存在, 键/值对就会存在于映射中, 并被当作对值的引用, 因此就不会被当作垃圾回收</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line">wm.set(&#123;&#125;, <span class="string">"val"</span>);</span><br><span class="line"><span class="comment">// &#123;&#125; 没有在其他地方使用到, 执行完之后 会被当做垃圾回收</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> container = &#123; </span><br><span class="line">    key: &#123;&#125; </span><br><span class="line">&#125;; </span><br><span class="line">wm.set(container.key, <span class="string">"val"</span>); </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeReference</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    container.key = <span class="literal">null</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// container 对象维护着一个对弱映射键的引用，因此这个对象键不会成为垃圾回收的目标, 不过, 如果调用了 removeReference(), 就会摧毁键对象的最后一个引用, 垃圾回收程序就可以把这个键/值对清理掉</span></span><br></pre></td></tr></table></figure>

<h4 id="不可迭代键"><a href="#不可迭代键" class="headerlink" title="不可迭代键"></a>不可迭代键</h4><p>因为 WeakMap 中的键/值对任何时候都可能被销毁, 所以没必要提供迭代其键/值对的能力, 当然, 也用不着像 clear()这样一次性销毁所有键/值的方法, WeakMap 确实没有这个方法。因为不可能迭代, 所以也不可能在不知道对象引用的情况下从弱映射中取得值. 即便代码可以访问 WeakMap 实,  也没办法看到其中的内容WeakMap 实例之所以限制只能用对象作为键, 是为了保证只有通过键对象的引用才能取得值, 如果允许原始值, 那就没办法区分初始化时使用的字符串字面量和初始化之后使用的一个相等的字符串了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 最简单的清空一个weakmap</span></span><br><span class="line">weakmap = <span class="keyword">new</span> <span class="built_in">WeakMap</span>(); <span class="comment">// 再重新初始化一下就好了</span></span><br></pre></td></tr></table></figure>

<h4 id="使用弱映射"><a href="#使用弱映射" class="headerlink" title="使用弱映射"></a>使用弱映射</h4><ol>
<li><p>私有变量</p>
<p>弱映射造就了在 JavaScript 中实现真正私有变量的一种新方式。前提很明确：私有变量会存储在弱映射中，以对象实例为键，以私有成员的字典为值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> User = <span class="function">(<span class="params">(</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>(id) &#123;</span><br><span class="line">            <span class="keyword">this</span>.idProperty = <span class="built_in">Symbol</span>(<span class="string">'id'</span>);</span><br><span class="line">            <span class="keyword">this</span>.setId(id);</span><br><span class="line">        &#125;</span><br><span class="line">        setPrivate(property, value) &#123; </span><br><span class="line">            <span class="keyword">const</span> privateMembers = wm.get(<span class="keyword">this</span>) || &#123;&#125;; </span><br><span class="line">            privateMembers[property] = value; </span><br><span class="line">            wm.set(<span class="keyword">this</span>, privateMembers); </span><br><span class="line">        &#125; </span><br><span class="line">        getPrivate(property) &#123; </span><br><span class="line">            <span class="keyword">return</span> wm.get(<span class="keyword">this</span>)[property]; </span><br><span class="line">        &#125; </span><br><span class="line">        setId(id) &#123; </span><br><span class="line">            <span class="keyword">this</span>.setPrivate(<span class="keyword">this</span>.idProperty, id); </span><br><span class="line">        &#125;</span><br><span class="line">        getId(id) &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.getPrivate(<span class="keyword">this</span>.idProperty); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> User;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> User(<span class="number">123</span>);</span><br><span class="line">user.getId(); <span class="comment">// 123</span></span><br><span class="line">user.setId(<span class="number">456</span>);</span><br><span class="line">user.getId(); <span class="comment">// 456</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>DOM节点元数据</p>
<p>因为 WeakMap 实例不会妨碍垃圾回收，所以非常适合保存关联元数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"><span class="keyword">const</span> loginButton = <span class="built_in">document</span>.querySelector(<span class="string">"#login"</span>);</span><br><span class="line">vm.set(loginButton, &#123; <span class="attr">disabled</span>: <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><p>ECMAScript 6 新增的 Set 是一种新集合类型，为这门语言带来集合数据结构, Set 在很多方面都像是加强的 Map, 这是因为它们的大多数 API 和行为都是共有的</p>
<h4 id="基本API-2"><a href="#基本API-2" class="headerlink" title="基本API"></a>基本API</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 new 关键字和 Set 构造函数可以创建一个空集合</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">set</span> = new Set();</span><br><span class="line"></span><br><span class="line">// 如果想在创建的同时初始化实例，则可以给 Set 构造函数传入一个可迭代对象, 其中需要包含插入到新集合实例中的元素</span><br><span class="line">// 使用数组初始化集合</span><br><span class="line">const set1 = new Set(["val1", "val2", "val3"]);</span><br><span class="line">set1.size; // 3</span><br><span class="line"></span><br><span class="line">// 使用自定义迭代器初始化集合</span><br><span class="line">const set2 = new Set(&#123; </span><br><span class="line">    [<span class="built_in">Symbol</span>.iterator]: <span class="function"><span class="keyword">function</span> * (<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">yield</span> <span class="string">"val1"</span>; </span><br><span class="line">        <span class="keyword">yield</span> <span class="string">"val2"</span>; </span><br><span class="line">        <span class="keyword">yield</span> <span class="string">"val3"</span>; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;);</span><br><span class="line">set2.size; <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>初始化之后, 可以使用 add()增加值, 使用 has()查询, 通过 size 取得元素数量, 以及使用 delete()和 clear()删除元素</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">set</span> = new Set();</span><br><span class="line"><span class="keyword">set</span>.has("name"); // false</span><br><span class="line"><span class="keyword">set</span>.delete("name"); // false</span><br><span class="line"><span class="keyword">set</span>.size; // 0</span><br><span class="line"><span class="keyword">set</span>.add(1).add(2).add(3).add(4);</span><br><span class="line"><span class="keyword">set</span>.size; // 4</span><br><span class="line"><span class="keyword">set</span>.has(1); // true</span><br><span class="line"><span class="keyword">set</span>.delete(1); // true</span><br><span class="line"><span class="keyword">set</span>.size; // 3</span><br><span class="line"><span class="keyword">set</span>.clear(); </span><br><span class="line"><span class="keyword">set</span>.size; // 0</span><br></pre></td></tr></table></figure>

<p>与 Map 类似，Set 可以包含任何 JavaScript 数据类型作为值, 集合也使用 SameValueZero 操作基本上相当于使用严格对象相等的标准来检查值的匹配性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">set</span> = new Set(); </span><br><span class="line"></span><br><span class="line">const functionVal = function() &#123;&#125;; </span><br><span class="line"><span class="keyword">const</span> symbolVal = <span class="built_in">Symbol</span>(); </span><br><span class="line"><span class="keyword">const</span> objectVal = <span class="keyword">new</span> <span class="built_in">Object</span>(); </span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>.add(functionVal).add(symbolVal).add(objectVal);</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>.has(function() &#123;&#125;); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<h4 id="顺序与迭代-1"><a href="#顺序与迭代-1" class="headerlink" title="顺序与迭代"></a>顺序与迭代</h4><p>Set 会维护值插入时的顺序，因此支持按顺序迭代</p>
<p>集合实例可以提供一个迭代器(Iterator), 能以插入顺序生成集合内容。可以通过 values()方法及其别名方法 keys() (或者 Symbol.iterator 属性, 它引用 values())取得这个迭代器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">set</span> = new Set(["val1", "val2", "val3"]);</span><br><span class="line"><span class="keyword">set</span>.values === <span class="keyword">set</span>[Symbol.iterator]; // true</span><br><span class="line"><span class="keyword">set</span>.keys === <span class="keyword">set</span>[Symbol.iterator]; // true</span><br><span class="line"></span><br><span class="line">let arr = [...<span class="keyword">set</span>]; // ["val1", "val2", "val3"]</span><br></pre></td></tr></table></figure>

<h4 id="定义正式集合操作"><a href="#定义正式集合操作" class="headerlink" title="定义正式集合操作"></a>定义正式集合操作</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookSet</span> <span class="title">extend</span> <span class="title">Set</span> </span>&#123;</span><br><span class="line">    union(...sets) &#123; </span><br><span class="line">        <span class="keyword">return</span> BookSet.union(<span class="keyword">this</span>, ...sets) </span><br><span class="line"> 	&#125; </span><br><span class="line"> 	intersection(...sets) &#123; </span><br><span class="line"> 		<span class="keyword">return</span> BookSet.intersection(<span class="keyword">this</span>, ...sets); </span><br><span class="line"> 	&#125; </span><br><span class="line"> 	difference(<span class="keyword">set</span>) &#123; </span><br><span class="line"> 		<span class="keyword">return</span> BookSet.difference(<span class="keyword">this</span>, <span class="keyword">set</span>); </span><br><span class="line"> 	&#125; </span><br><span class="line"> 	symmetricDifference(<span class="keyword">set</span>) &#123; </span><br><span class="line"> 		<span class="keyword">return</span> BookSet.symmetricDifference(<span class="keyword">this</span>, <span class="keyword">set</span>); </span><br><span class="line"> 	&#125;</span><br><span class="line"> 	cartesianProduct(<span class="keyword">set</span>) &#123; </span><br><span class="line"> 		<span class="keyword">return</span> BookSet.cartesianProduct(<span class="keyword">this</span>, <span class="keyword">set</span>); </span><br><span class="line"> 	&#125;</span><br><span class="line"> 	powerSet() &#123; </span><br><span class="line"> 		<span class="keyword">return</span> BookSet.powerSet(<span class="keyword">this</span>); </span><br><span class="line"> 	&#125;</span><br><span class="line">    <span class="comment">// 返回两个或者多个集合的并集</span></span><br><span class="line">    <span class="keyword">static</span> union(a, ...bSets) &#123; </span><br><span class="line">        <span class="keyword">const</span> unionSet = <span class="keyword">new</span> BookSet(a); </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> b <span class="keyword">of</span> bSets) &#123; </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> bValue <span class="keyword">of</span> b) &#123; </span><br><span class="line">                unionSet.add(bValue); </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> unionSet;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回两个或者多个的交集</span></span><br><span class="line">    <span class="keyword">static</span> intersection(a, ...bSets) &#123; </span><br><span class="line">        <span class="keyword">const</span> intersectionSet = <span class="keyword">new</span> BookSet(a); </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> aValue <span class="keyword">of</span> intersectionSet) &#123; </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> b <span class="keyword">of</span> bSets) &#123; </span><br><span class="line">                <span class="keyword">if</span> (!b.has(aValue)) &#123; </span><br><span class="line">                    intersectionSet.delete(aValue); </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> intersectionSet; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回两个集合的差集</span></span><br><span class="line">    <span class="keyword">static</span> difference(a, b) &#123; </span><br><span class="line">        <span class="keyword">const</span> differenceSet = <span class="keyword">new</span> XSet(a); </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> bValue <span class="keyword">of</span> b) &#123; </span><br><span class="line">            <span class="keyword">if</span> (a.has(bValue)) &#123; </span><br><span class="line">                differenceSet.delete(bValue); </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> differenceSet; </span><br><span class="line">    &#125;</span><br><span class="line">   	<span class="comment">// 返回两个集合的对称差集</span></span><br><span class="line">    <span class="keyword">static</span> symmetricDifference(a, b) &#123; </span><br><span class="line">        <span class="comment">// 按照定义，对称差集可以表达为</span></span><br><span class="line">        <span class="keyword">return</span> a.union(b).difference(a.intersection(b)); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回两个集合（数组对形式）的笛卡儿积</span></span><br><span class="line"> 	<span class="comment">// 必须返回数组集合，因为笛卡儿积可能包含相同值的对</span></span><br><span class="line"> 	<span class="keyword">static</span> cartesianProduct(a, b) &#123; </span><br><span class="line">        <span class="keyword">const</span> cartesianProductSet = <span class="keyword">new</span> XSet(); </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> aValue <span class="keyword">of</span> a) &#123; </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> bValue <span class="keyword">of</span> b) &#123; </span><br><span class="line">                cartesianProductSet.add([aValue, bValue]); </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> cartesianProductSet; </span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">// 返回一个集合的幂集</span></span><br><span class="line"> 	<span class="keyword">static</span> powerSet(a) &#123; </span><br><span class="line"> 	<span class="keyword">const</span> powerSet = <span class="keyword">new</span> XSet().add(<span class="keyword">new</span> XSet()); </span><br><span class="line"> 	<span class="keyword">for</span> (<span class="keyword">const</span> aValue <span class="keyword">of</span> a) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">set</span> of new XSet(powerSet)) &#123; </span><br><span class="line">            powerSet.add(<span class="keyword">new</span> XSet(<span class="keyword">set</span>).add(aValue)); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">        return powerSet; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h3><p>ECMAScript 6 新增的”弱集合”(WeakSet)是一种新的集合类型, 为这门语言带来了集合数据结构, WeakSet 是 Set 的”兄弟”类型, 其 API 也是 Set 的子集, WeakSet 中的”weak”(弱), 描述的是 JavaScript 垃圾回收程序对待”弱集合”中值的方式</p>
<h4 id="基本API-3"><a href="#基本API-3" class="headerlink" title="基本API"></a>基本API</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以使用 new 关键字实例化一个空的 WeakSet</span></span><br><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 弱集合中的值只能是 Object 或者继承自 Object 的类型，尝试使用非对象设置值会抛出 TypeError。</span></span><br><span class="line"><span class="comment">// 如果想在初始化时填充弱集合，则构造函数可以接收一个可迭代对象，其中需要包含有效的值, 可迭代对象中的每个值都会按照迭代顺序插入到新实例中</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> val1 = &#123;<span class="attr">id</span>: <span class="number">1</span>&#125;, </span><br><span class="line">      val2 = &#123;<span class="attr">id</span>: <span class="number">2</span>&#125;, </span><br><span class="line">      val3 = &#123;<span class="attr">id</span>: <span class="number">3</span>&#125;;</span><br><span class="line"><span class="comment">// 使用数组初始化弱集合</span></span><br><span class="line"><span class="keyword">const</span> ws1 = <span class="keyword">new</span> <span class="built_in">WeakSet</span>([val1, val2, val3]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化是全有或全无的操作</span></span><br><span class="line"><span class="comment">// 只要有一个值无效就会抛出错误，导致整个初始化失败</span></span><br><span class="line"><span class="keyword">const</span> ws2 = <span class="keyword">new</span> <span class="built_in">WeakSet</span>([val1, <span class="string">"BADVAL"</span>, val3]); </span><br><span class="line"><span class="comment">// TypeError: Invalid value used in WeakSet </span></span><br><span class="line"><span class="keyword">typeof</span> ws2; </span><br><span class="line"><span class="comment">// ReferenceError: ws2 is not defined</span></span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Decade W</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://blog.decade.run/2020/12/22/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%AC%94%E8%AE%B0/">http://blog.decade.run/2020/12/22/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.decade.run" target="_blank">王小明</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AF%BB%E5%90%8E%E7%AC%94%E8%AE%B0/">读后笔记</a></div><div class="post_share"><div class="social-share" data-image="/img/coverimg/vue.jpg" data-sites="twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2021/01/25/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E4%B8%83%E7%AB%A0-%E7%AC%94%E8%AE%B0/"><img class="prev_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JavaScript高级程序设计第四版-第七章-笔记</div></div></a></div><div class="next-post pull_right"><a href="/2020/11/19/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AC%AC%E5%9B%9B%E7%89%88-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%AC%94%E8%AE%B0/"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JavaScript高级程序设计第四版-第五章-笔记</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2021/01/25/JavaScript高级程序设计第四版-第七章-笔记/" title="JavaScript高级程序设计第四版-第七章-笔记"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-01-25</div><div class="relatedPosts_title">JavaScript高级程序设计第四版-第七章-笔记</div></div></a></div><div class="relatedPosts_item"><a href="/2020/11/19/JavaScript高级程序设计第四版-第五章-笔记/" title="JavaScript高级程序设计第四版-第五章-笔记"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-11-19</div><div class="relatedPosts_title">JavaScript高级程序设计第四版-第五章-笔记</div></div></a></div><div class="relatedPosts_item"><a href="/2021/01/27/JavaScript高级程序设计第四版-第八章-笔记/" title="JavaScript高级程序设计第四版-第八章-笔记"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-01-27</div><div class="relatedPosts_title">JavaScript高级程序设计第四版-第八章-笔记</div></div></a></div><div class="relatedPosts_item"><a href="/2021/02/19/JavaScript高级程序设计第四版-第十一章-笔记/" title="JavaScript高级程序设计第四版-第十一章-笔记"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-02-19</div><div class="relatedPosts_title">JavaScript高级程序设计第四版-第十一章-笔记</div></div></a></div><div class="relatedPosts_item"><a href="/2020/11/18/JavaScript高级程序设计第四版-第四章-笔记/" title="JavaScript高级程序设计第四版-第四章-笔记"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-11-18</div><div class="relatedPosts_title">JavaScript高级程序设计第四版-第四章-笔记</div></div></a></div><div class="relatedPosts_item"><a href="/2021/02/05/JavaScript高级程序设计第四版-第九章-笔记/" title="JavaScript高级程序设计第四版-第九章-笔记"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-02-05</div><div class="relatedPosts_title">JavaScript高级程序设计第四版-第九章-笔记</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  appId: 'WzoNQ79zXHpLGhYhAiHrDU9m-gzGzoHsz',
  appKey: 'Nhmax4ME4ul4BPqWy3GGqIFq',
  placeholder: 'Please leave your footprints',
  avatar: '',
  meta: guest_info,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: true,
  serverURLs: '',
  mathjax: false
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Decade W</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi,  welcome  to  my  <a  href="http://blog.decade.run/">blog</a>!</div><div class="icp"><a href="http://beian.miit.gov.cn" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>互联网ICP备案:渝ICP备19015868号</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Search</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="canvas_nest" color="106,90,205" opacity="0.7" zIndex="-1" count="199" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/third-party/ClickShowText.js"></script><script src="/js/search/algolia.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"></script><div class="waifu"><div class="hide-button">隐藏</div><div class="waifu-tips"></div><canvas class="live2d" id="live2d" width="200" height="300"></canvas></div><script src="/lib/waifu-tips.js" async></script><script src="/lib/live2d.js"></script><script src="/lib/run.js"></script></body></html>